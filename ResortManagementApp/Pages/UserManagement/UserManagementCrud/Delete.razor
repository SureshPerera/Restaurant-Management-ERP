@page "/UserManagement/Delete/{Id:guid}"
@using ResortManagementApp.Models.Reservation
@using ResortManagementApp.Models.Reservation.DTO
@using ResortManagementApp.Models.UserManagement
@using ResortManagementApp.Pages.ComponentCss
@layout MainLayout

<div class="card mb-3 p-3">
	<h3 class="text-center">Delete User</h3>
</div>

<div class="p-3">
	@if (UserManagementDto == null)
	{
		<p><Searching /></p>
	}
	else
	{
		<p>
			Are you sure you want to delete user with Name
			<strong>@UserManagementDto.FirstName @UserManagementDto.LastName</strong>?
		</p>

		<div class="d-flex gap-2">
			<button class="btn btn-danger" @onclick="DeleteUser">Delete</button>
			<a class="btn btn-secondary" href="/UserManagement">Cancel</a>
		</div>
	}
</div>

@inject HttpClient http
@inject NavigationManager navManager


@code {
	[Parameter]
	public Guid Id { get; set; }
	public List<UserManagement>? UserManagements { get; set; }
	public UserManagementDto? UserManagementDto { get; set; } = new();

	protected override async Task OnInitializedAsync()
	{
		try
		{
			// Fetch the customer's info by ID
			UserManagementDto = await http.GetFromJsonAsync<UserManagementDto>($"https://localhost:4000/api/UserManagements/{Id}");

		}
		catch (Exception ex)
		{
			Console.WriteLine("Error loading customer: " + ex.Message);
		}
	}


	private async Task DeleteUser(MouseEventArgs args)
	{
		try
		{
			var responce = await http.DeleteFromJsonAsync<UserManagement>($"https://localhost:4000/api/UserManagement/{Id}");

			navManager.NavigateTo("/UserManagement");
		}
		catch (Exception ex)
		{
			Console.WriteLine("Erro : " + ex.Message);
		}
	}
	
}
