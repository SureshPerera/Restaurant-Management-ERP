@using ResortManagementApp.Models.Reservation.DTO
@using ResortManagementApp.Models.Reservation.OnlineBookingModel
@using ResortManagementApp.Pages
@using MudBlazor
@using Microsoft.AspNetCore.Components
@using System.Globalization
@using ResortManagementApp.Pages.Reservations.OnlineBookingModelCrud
@using System.Text.Json.Nodes
@using static System.Net.WebRequestMethods
@inject MudBlazor.IDialogService DialogService

@inject IJSRuntime jsruntime
@layout ClientLayout


@page "/"
<div style="margin-top:-4rem;">

	<section style="background-color:azure;">
		<div>
			<MudCarousel Class="mud-width-full" Style="height:500px;" ShowArrows="@arrows" ShowBullets="@bullets" EnableSwipeGesture="@enableSwipeGesture" AutoCycle="@autocycle" TData="object">
				<MudCarouselItem Transition="transition" Color="@Color.Primary">
					<div class="d-flex" style="height:100%">
						@* <MudIcon Class="mx-auto my-auto" Icon="@Icons.Custom.Brands.MudBlazor" Size="@Size.Large" /> *@
						<img src="/imgs/clientpotal/clienthomeimg/front1.jpeg" alt="Image 1" class="cover-photo mx-auto my-auto" style="max-width:100%; height:100%;" />

					</div>
				</MudCarouselItem>
				<MudCarouselItem Transition="transition" Color="@Color.Secondary">
					<div class="d-flex" style="height:100%">
						@* <MudIcon Class="mx-auto my-auto" Icon="@Icons.Custom.Brands.MudBlazor" Size="@Size.Large" /> *@
						<img src="/imgs/clientpotal/clienthomeimg/front2.jpeg" alt="Image 2" class="cover-photo mx-auto my-auto" style="max-width:100%; height:100%;" />

					</div>
				</MudCarouselItem>
				<MudCarouselItem Transition="transition">
					<div class="d-flex" style="height:100%">
						@* <MudIcon Class="mx-auto my-auto" Icon="@Icons.Custom.Brands.MudBlazor" Color="@Color.Primary" Size="@Size.Large" /> *@
						<img src="/imgs/clientpotal/clienthomeimg/front3.jpeg" alt="Image 3" class="cover-photo mx-auto my-auto" style="max-width:100%; height:100%;" />

					</div>
				</MudCarouselItem>
				<MudCarouselItem Transition="transition">
					<div class="d-flex" style="height:100%">
						@* <MudIcon Class="mx-auto my-auto" Icon="@Icons.Custom.Brands.MudBlazor" Color="@Color.Primary" Size="@Size.Large" /> *@
						<img src="/imgs/clientpotal/clienthomeimg/front4.jpeg" alt="Image 4" class="cover-photo mx-auto my-auto" style="max-width:100%; height:100%;" />

					</div>
				</MudCarouselItem>
			</MudCarousel>

		</div>

	</section>
	<section style="background-color:#344E41; margin-top:-2.1rem; height:3rem;">
		<div class="fixed-div" style="background-color:#344E41">
			<div class="nav-item px-3">
				<NavLink class="nav-link" href="/" Match="NavLinkMatch.All">
					<span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> OFFERS
				</NavLink>
			</div>
			<div class="nav-item px-3">
				<NavLink class="nav-link" href="/" Match="NavLinkMatch.All">
					<span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> EXPERIENCES
				</NavLink>
			</div>
			<div class="nav-item px-3">
				<NavLink class="nav-link" href="/" Match="NavLinkMatch.All">
					<span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> EVENT
				</NavLink>
			</div>
			<div class="nav-item px-3">
				<NavLink class="nav-link" href="/" Match="NavLinkMatch.All">
					<span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> ESG
				</NavLink>
			</div>
			<div class="nav-item px-3">
				<NavLink class="nav-link" href="/" Match="NavLinkMatch.All">
					<span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> GIFT CARDS
				</NavLink>
			</div>
			<div class="nav-item px-3">
				<NavLink class="nav-link" href="/" Match="NavLinkMatch.All">
					<span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> ABOUT US
				</NavLink>
			</div>
			<div class="nav-item px-3">
				<NavLink class="nav-link" href="/" Match="NavLinkMatch.All">
					<span class="bi bi-house-door-fill-nav-menu" aria-hidden="true"></span> BOOK DIRECT
				</NavLink>
			</div>
		</div>

	</section>

	<section style="background-color: #A3B18A; margin-top: 0.4rem; padding: 10px;">
		<div class="">
			<form class="con3-quckBooking-section3" action="/frontoffice" method="post" style="">
				<div class="position-absolute justify-content-center flex">
					<div style="width: 250px;">
						<MudSelect T="DropdownWidth" Label="Resort Width" @bind-Value="@_dropdownWidth">
							<MudSelectItem Value="@DropdownWidth.Relative" >Solitary Green Resort - Nuwara Eliya</MudSelectItem>
						</MudSelect>
					</div>
					<span style="font-size:50px;margin-top:-1rem;">|</span>
					<div style="margin-top: 0.5rem">
						<MudStack AlignItems="AlignItems.Center" Style="width:450px; height:50px; margin:-1rem;">
							<MudDateRangePicker PickerVariant="@_variant" @bind-DateRange="@_dateRange" Margin="Margin.Dense" Label="Select date range" />
							<MudSpacer />
							<MudToggleGroup T="PickerVariant" SelectionMode="SelectionMode.SingleSelection" Value="@_variant" ValueChanged="@OnValueChanged"
											Color="Color.Primary" CheckMark="true" FixedContent="false">

							</MudToggleGroup>
						</MudStack>
					</div>
					<span style="font-size:50px;margin-top:-1rem;">|</span>
					
					<div style="">
						<select style="height:3rem; background-color:transparent" @bind="onlineBookingModel.NoOfRooms"  required>
							<option>--Rooms--</option>
							<option>1</option>
							<option>2</option>
							<option>3</option>
							<option>4</option>
							<option>5</option>
						</select>
					</div>
					<div style="">
						<select style="height:3rem; background-color:transparent" @bind="onlineBookingModel.NoOfAdults" required>
							<option>--Adults--</option>
							<option>1</option>
							<option>2</option>
							<option>3</option>
							<option>4</option>
							<option>5</option>
						</select>
					</div>
					<div style="">
						
						<select style="height:3rem; background-color:transparent" @bind="onlineBookingModel.NoOfChildren" required>
							<option>--Children--</option>
							<option>1</option>
							<option>2</option>
							<option>3</option>
							<option>4</option>
							<option>5</option>
						</select>

					</div>
					<span style="font-size:50px;margin-top:-1rem;">|</span>
					<div style="">
						<input style="height:3rem; background-color:transparent" type="text" name="promoCode" @bind="onlineBookingModel.PramoCode" placeholder="Promo Code" />
					</div>
					<span style="font-size:50px;margin-top:-1rem;">|</span>
					<div style="">
						<input style="height:3rem; background-color:transparent" type="text" name="country"  placeholder="@UserCountry" readonly />

					</div>
					<span style="font-size:50px;margin-top:-1rem;">|</span>

					<div>
						<button class="btn btn-primary" @onclick="NavigateToCustomerDetails">ClickToBooking</button>
					</div>
				</div>	
			</form>
		</div>

	</section>
	<section style="margin-top:-4rem; width: 100%;">
		<div class="" style=" display:flex ; font-family:'Lucida Sans Typewriter'; font-weight:bold	; margin-top:-2rem; justify-content:center">
			<div>


				<img style="width:550px; height:500px;" src="/imgs/maindashboard/logo.png" />
			</div>


		</div>
		<div style="font-family:'Lucida Sans Typewriter'; font-weight:bold	; margin-top:-2rem; justify-content:center; display:flex;">
			<div style="margin-top:-2rem; width:50%; font-size:16px;  font-weight: bold; color:white; backdrop-filter: blur(1rem); backdrop-filter:drop-shadow(20%);  justify-items: baseline ; background-color: rgba(0, 0, 0, 0.4);">
				<p style="">"Perched amidst the misty hills and emerald tea plantations of Nuwara Eliya, Solitary Green Resort offers a serene escape into nature’s embrace. This boutique retreat combines tranquility and elegance, featuring private terraces with breathtaking views of rolling landscapes and lush greenery. Immerse yourself in the cool mountain air, unwind in comfort, and experience the perfect blend of luxury and solitude in Sri Lanka’s scenic highlands."</p>

			</div>
		</div>

	</section>

	<section class="services-section" style="padding:2rem; ">
		<MudPaper Class="pa-4">
			<MudStack Spacing="2">
				<MudButton OnClick="OnExpandCollapseClick" Color="Color.Primary">
					@(_expanded ? "Collapse" : "SERVICES & FACILITIES")
				</MudButton>
				<MudDivider />
				<MudCollapse Expanded="_expanded">
					<div class="services-grid"
						 style="display:grid; grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));
                            gap:2rem; justify-items:center; align-items:start; font-family:'Lucida Sans Typewriter';">
						@foreach (var service in new (string Img, string Title, string Desc)[] {
												("/imgs/clientpotal/clienthomeimg/marketeq--wifi.png", "WiFi", "Available throughout hotel."),
												("/imgs/clientpotal/clienthomeimg/equptment.png","Equipment","Bicycles & snorkelling gear for guests’ use."),
												("/imgs/clientpotal/clienthomeimg/sweming.png","Swimming Pools","Two gorgeous pools with views."),
												("/imgs/clientpotal/clienthomeimg/parking.png","Secure Parking","Available outside."),
												("/imgs/clientpotal/clienthomeimg/spa.png","La Parenthèse","Spa."),
												("/imgs/clientpotal/clienthomeimg/laudary.png","Laundry Services","Available on request."),
												("/imgs/clientpotal/clienthomeimg/houseKeping.png","Housekeeping","Offered daily."),
												("/imgs/clientpotal/clienthomeimg/Lounging.png","Lounging","Sunbeds, hammocks and loungers.")
												})
						{
							<div class="service-card" style="background-color:@(service.Title.GetHashCode() % 2 == 0 ? "#C5E1A5" : "antiquewhite");
	                                                         width:150px; border-radius:1.5rem; padding:1rem; text-align:center;
	                                                         box-shadow:0 4px 6px rgba(0,0,0,0.1); transition: transform 0.3s;">
								<img src="@service.Img" alt="@service.Title" style="width:50px; height:50px; margin-bottom:0.5rem;" />
								<div style="font-size:16px; font-weight:bold; margin-bottom:0.25rem;">@service.Title</div>
								<div style="font-size:14px; color:#333;">@service.Desc</div>
							</div>
						}
					</div>
				</MudCollapse>
			</MudStack>
		</MudPaper>
	</section>

	<style>
		.service-card:hover {
			transform: translateY(-5px);
			box-shadow: 0 8px 12px rgba(0,0,0,0.2);
		}

		

		.service-card {
			width: 100%;
		}

		
	</style>



	<section style="margin:0; padding:0; ">
		<div class="video-container" style="position:fixed; top:0; left:0; width:100vw; height:100vh; z-index:-1; overflow:hidden; backdrop-filter:blur(80px)">
			<video autoplay loop muted playsinline
				   style="width:100vw; height:100vh; object-fit:cover; backdrop-filter: brightness(50%);
						filter: blur(2px);">
				<source src="/video/clientportel/promovideo.mp4" type="video/mp4" />
			</video>
		</div>
	</section>

	<section>
	</section>

</div>


<style type="text/css">
	.con1-welcom-section1 {
		font-family: cursive;
		text-align: center;
	}

	.con2-selectbar-secton2 {
		display: flex;
		gap: 1rem;
		justify-content: center;
		height: 1rem;
	}

	.con3-quckBooking-section3 {
		display: flex;
		gap: 1rem;
		justify-content: center;
		height: 3rem;
		color: black;
	}

	.cover-photo {
		width: 100%;
		height: 100%;
		object-fit: cover; /* Ensures the image covers the entire container */
	}

	.bg-container-allSection {
		background-size: cover;
		background-position: center;
		background-repeat: no-repeat;
		width: 100vw;
		height: auto;
		display: flex;
		align-items: center;
		justify-content: center;
		color: black;
	}

</style>

@inject IJSRuntime JS
@inject HttpClient http
@inject NavigationManager navManager

@code {
	public CustomerUsePcInfoDto CustomerUsePcInfoDto = new CustomerUsePcInfoDto();
	public OnlineBookingModel onlineBookingModel = new OnlineBookingModel();
	public string UserCountry;
	private DropdownWidth _dropdownWidth ;
	public OnlineBookingModel onlineBooking = new();
	private bool arrows = true;
	private bool bullets = true;
	private bool enableSwipeGesture = true;
	private bool autocycle = true;
	private Transition transition = Transition.Fade;
	private PickerVariant _variant = PickerVariant.Dialog;
	private DateRange _dateRange { get; set; }
	public JsonNode Errors { set; get; } = new JsonObject();


	protected async override Task OnInitializedAsync()
	{

		try
		{
			var result = await http.GetFromJsonAsync<CustomerUsePcInfoDto>(
				"https://localhost:4000/api/Geo/country"
			);

			if (result != null)
			{
				UserCountry = result.Country;

			}
			else
			{
				UserCountry = "Unknown";
			}
		}
		catch (Exception ex)
		{
			Console.WriteLine($"Error fetching country info: {ex.Message}");
			UserCountry = "Unknown";
		}
	}
	private void OnValueChanged(PickerVariant variant)
	{
		_dateRange = null;
		_variant = variant;
	}
	private string? stringValue { get; set; }

	private string? userInput { get; set; }
	private string? promoCodeInput { get; set; }

	bool _expanded = true;

	private void OnExpandCollapseClick()
	{
		_expanded = !_expanded;
	}

	public string? VideoSource = "images/ClientHomeVideo/video.mp4";



	private void NavigateToCustomerDetails(MouseEventArgs args)
	{
		var queryParams = new Dictionary<string, object?>
		{
			["country"] = UserCountry,
			["checkIn"] = _dateRange?.Start?.ToString("yyyy-MM-dd"),
			["checkOut"] = _dateRange?.End?.ToString("yyyy-MM-dd"),
			["rooms"] = onlineBookingModel.NoOfRooms,
			["adults"] = onlineBookingModel.NoOfAdults,
			["children"] = onlineBookingModel.NoOfChildren,
			["pramoCode"] = onlineBookingModel.PramoCode
		};

		var uri = navManager.GetUriWithQueryParameters("/Reservations/OnlineBookingModel/CustomerDetailsForm", queryParams);
		navManager.NavigateTo(uri);
	}
}