@page "/ClientManagement/AdvancePay/{Id:guid}"
@using ResortManagementApp.Models.ClientManagement.AdvancePay
@using ResortManagementApp.Models.Reservation
@using ResortManagementApp.Pages.ComponentCss
@using System.Text.Json.Nodes
@inject HttpClient Http
@layout MainLayout

<div>
	<h3 class="mb-3 text-center">Advance Payment</h3>
</div>
<div>
	<form class="form">
		<div class="flex" style="height: fit-content; width: fit-content;">
			<div class="gap-4">
				<div class="row form-group mb-3">
					<label class="col-md-4 col-form-label">Booking Id</label>
					<div class="col-md-8">
						<input class="form-control" @bind="AdvancePayDto.DirectBookingId">
						<span class="text-danger">@Errors["DirectBookingId"]?[0]</span>
					</div>
				</div>
				<div class="row form-group mb-3">
					<label class="col-md-4 col-form-label">Paying Amount</label>
					<div class="col-md-8">
						<input class="form-control" @bind="AdvancePayDto.PayingAmount">
						<span class="text-danger">@Errors["PayingAmount"]?[0]</span>
					</div>
				</div>
				<div class="row form-group mb-3">
					<label class="col-md-4 col-form-label">Payment Type</label>
					<div class="col-md-8">
						<select class="form-select" @bind="AdvancePayDto.PaymentType">
							<options>--Select--</options>
							@foreach (var item in PaymentType)
							{
								<option>@item</option>
							}

						</select>
						<span class="text-danger">@Errors["PaymentType"]?[0]</span>
					</div>
				</div>
				<div class="row form-group mb-3">
					<label class="col-md-4 col-form-label">Order Type</label>
					<div class="col-md-8">
						<input class="form-control" @bind="AdvancePayDto.OderType">
						<span class="text-danger">@Errors["OderType"]?[0]</span>
					</div>
				</div>
				<div class="row form-group mb-3">
					<label class="col-md-4 col-form-label">Order Date</label>
					<div class="col-md-8">
						<input class="form-control" @bind="AdvancePayDto.OderDate" readonly>
						<span class="text-danger">@Errors["OderDate"]?[0]</span>
					</div>
				</div>
				<div class="row form-group mb-3">
					<label class="col-md-4 col-form-label">Order Details</label>
					<div class="col-md-8">
						<input class="form-control" @bind="AdvancePayDto.Details">
						<span class="text-danger">@Errors["Details"]?[0]</span>
					</div>
				</div>
			</div>
			<div class="">
				@if (AdvancePayDto.PaymentType == "Bank")
				{
					<div  class="row form-group mb-3">
						<label class="col-md-4 col-form-label">Bank Account No</label>
						<div class="col-md-8">
							<select class="form-select" >
								<options>--Select--</options>
								@foreach (var item in BankAccountNos)
								{
									<option>@item</option>
								}

							</select>
							<span class="text-danger">@Errors["PaymentType"]?[0]</span>
						</div>
					</div>
				}
				
			</div>
			<div class="row">
				<div>
					<div class="row gap-2" style="justify-content:end; ">
						<div class="offset-md-4 col-md-4 d-grid">
							<button class="btn btn-success fw-bold" type="button" @onclick="MakePay">Pay</button>
						</div>
						<div class="offset-md-4 col-md-4 d-grid">
							<a class="btn btn-primary fw-bold" href="/ClientManagement/AdvancePayHistory/@Id">Advance Pay History</a>
						</div>
						<div class="offset-md-4 col-md-4 d-grid">
							<button class="btn btn-warning fw-bold" type="reset">Clear</button>
						</div>
						<div class="offset-md-4 col-md-4 d-grid">
							<a class="btn btn-primary fw-bold" href="/ClientManagement">Back</a>
						</div>
					</div>
				</div>

			</div>
		</div>

	</form>

</div>
<style>
	.form {
		display: flex;
		flex-direction: column;
		background-color: transparent;
		color: black;
		width: 60rem;
		font-weight: bold;
	}
</style>
@code {
	[Parameter]
	public Guid Id { get; set; }
	public List<AdvancePay>? AdvancePays { get; set; }
	public AdvancePayDto AdvancePayDto { get; set; } = new();

	public JsonNode Errors { get; set; } = new JsonObject();
	public List<string> PaymentType = new List<string>
	{
		"Cash","Card","Bank","Cheque","Vaucher","Takeaway"
	};
	public List<string> BankAccountNos = new List<string>
	{
		"BOC - 256854751","Peoples - 2513625421874568","HNB - 25364128"
	};
	protected override Task OnInitializedAsync()
	{

		AdvancePayDto.DirectBookingId = this.Id;

		AdvancePayDto.OderDate = DateTime.Now;
		return base.OnInitializedAsync();
	}

	private Task MakePay(MouseEventArgs args)
	{
		throw new NotImplementedException();
	}
}
