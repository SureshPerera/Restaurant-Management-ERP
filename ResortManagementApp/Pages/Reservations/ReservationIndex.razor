@page "/Reservations"
@using ResortManagementApp.Models.Administration.ManageAgents
@using ResortManagementApp.Models.Reservation
@using ResortManagementApp.Models.Reservation.DTO
@using ResortManagementApp.Models.Reservation.OnlineBookingModel
@using ResortManagementApp.Pages.ComponentCss
@using ResortManagementApp.Pages.Reservations.OnlineBookingModelCrud
@inject HttpClient Http

@layout MainLayout

<div style="">
	<div>
		<h3 class="mb-3 text-center">Reservation Management</h3>
	</div>
	<div class="flex">
		<div class="" style="margin-left: -0.2rem">
			<div>
				<a href="/Reservations/DirectBooking" class="btn btn-primary mb-3">Direct Booking</a>
			</div>
			<div>
				<a href="/Reservations/AgentBooking" class="btn btn-primary mb-3">Agent Booking</a>
			</div>
			<div>
				<a href="/Reservations/OnlineBooking" class="btn btn-primary mb-3">Online Booking</a>
			</div>
		</div>

		<div class="flex-wrap" style="display:flex; flex-direction: column; gap: 2rem;">
			<div class="justify-content-end flex flex-wrap gap-1" style="font-weight:bolder">
				<div style="">
					<input style="width: auto; height: 50px;" type="button" class="btn btn-warning mb-3 text-center" name="name" value="View all reservation" />
				</div>
				<div>
					<input style="width: auto; height: 50px;" type="button" class="btn btn-warning mb-3 text-center" name="name" value="View all confirmed reservation" />
				</div>
				<div>
					<input style="width: auto; height: 50px;" type="button" class="btn btn-warning mb-3 text-center" name="name" value="View all tempary reservation" />
				</div>
				<div>
					<input style="width: auto; height: 50px;" type="button" class="btn btn-warning mb-3 text-center" name="name" value="View all reservation by agent" />
				</div>
				<div>
					<input style="width: auto; height: 50px;" type="button" class="btn btn-warning mb-3 text-center" name="name" value="View all cancell reservation" />
				</div>
			</div>
			<div style="">
				@* directBookingTable *@
				<div style="">
					<div>
						<label>Direct Booking List</label>
					</div>
					@if (directBookingModels == null)
					{
						<div class="flex">

							<Searching />
						</div>
					}
					else
					{
						<table class="table" style="box-shadow: 0 8px 16px rgba(0, 0, 0, 0.25);">
							<thead class="bg-light">
								<tr class="table" style=" background-color: #A3B18A; font-weight: bold; font-size: 16px;">
									<td>Name</td>
									<td>Phone Number</td>
									<td>Address</td>
									<td>EmailAddress</td>
									<td>NIC</td>
									<td>Customer Type</td>
									<td>CreditLimit</td>
									<td>OpeningBalanace</td>
									<td>Nationality</td>
									<td>Remark</td>
								</tr>
							</thead>
							<tbody class="bg-light">
								@foreach (var item in directBookingModels)
								{
									<tr style="background-color: #DAD7CD">
										<th>@(item.FirstName + " " + @item.LastName)</th>
										<th>@item.PhoneNumber</th>
										<th>@item.Address</th>
										<th>@item.EmailAddress</th>
										<th>@item.NIC</th>
										<td>@item.CustomerType</td>
										<th>@item.CreditLimit</th>
										<th>@item.OpeningBalanace</th>
										<th>@item.Nationality</th>
										<th>@item.Remark</th>
									</tr>
								}
							</tbody>

						</table>
					}

				</div>
				@* onlineBookingTable *@


				<div style="">
					<div>
						<label>Online Booking List</label>
					</div>
					@if (OnlineBookings == null)
					{
						<div class="flex">

							<Searching />
						</div>
					}
					else
					{
						<table class="table" style="box-shadow: 0 8px 16px rgba(0, 0, 0, 0.25);">
							<thead class="bg-light">
								<tr class="table" style=" background-color: #A3B18A; font-weight: bold; font-size: 16px;">
									<td>Name</td>
									<td>Check-In_Date</td>
									<td>Check-Out-Date</td>
									<td>Rooms</td>
									<td>Adults</td>
									<td>Children</td>
									<td>Phone Number</td>
									<td>EmailAddress</td>
									<td>NIC</td>
									<td>Nationality</td>
								</tr>
							</thead>
							<tbody class="bg-light">
								@foreach (var item in OnlineBookings)
								{
									<tr style="background-color: #DAD7CD">
										<th>@(item.FirstName + " " + @item.LastName)</th>
										<th>@item.CheckInDate</th>
										<th>@item.CheckOutDate</th>
										<th>@item.NoOfRooms</th>
										<th>@item.NoOfAdults</th>
										<th>@item.NoOfChildren</th>

										<th>@item.PhoneNumber</th>

										<th>@item.EmailAddress</th>
										<th>@item.NIC</th>
										<th>@item.Nationality</th>



									</tr>
								}
							</tbody>

						</table>
					}

				</div>
				@* AgentBooking *@
				<div style="">
					<div>
						<label>Agent Booking List</label>
					</div>
					@if (Agents == null)
					{
						<div class="flex">
							<Searching />
						</div>
					}
					else
					{
						<table class="table" style="box-shadow: 0 8px 16px rgba(0, 0, 0, 0.25);">
							<thead class="bg-light">
								<tr class="table" style=" background-color: #A3B18A; font-weight: bold; font-size: 16px;">
									<td>Name</td>
									<td>Phone Number</td>
									<td>Address</td>
									<td>EmailAddress</td>
									<td>NIC</td>
									<td>CreditLimit</td>
								</tr>
							</thead>
							<tbody class="bg-light">
								@foreach (var item in Agents)
								{
									<tr style="background-color: #DAD7CD">
										<th>@(item.AgentName)</th>

										<th>@item.Mobile</th>
										<th>@item.AgentAddress</th>
										<th>@item.Email</th>
										<th>@item.NIC</th>
										<th>@item.CreditLimit</th>
									</tr>
								}
							</tbody>

						</table>
					}

				</div>
			</div>



		</div>
	</div>

</div>

<style>
	label {
		color: white;
		background-color: black;
		font-size: 16px;
		font-weight: bold;
	}
</style>



@code {
	private List<DirectBookingModel>? directBookingModels = new List<DirectBookingModel>();
	private List<OnlineBookingModel>? OnlineBookings = new List<OnlineBookingModel>();
	private List<Agents>? Agents = new List<Agents>();

	protected override async Task OnInitializedAsync()
	{
		try
		{
			directBookingModels = await Http.GetFromJsonAsync<List<DirectBookingModel>>("https://localhost:4000/api/DirectBooking");
			OnlineBookings = await Http.GetFromJsonAsync<List<OnlineBookingModel>>("https://localhost:4000/api/OnlineBooking");
			Agents = await Http.GetFromJsonAsync<List<Agents>>("https://localhost:4000/api/Agent");

		}
		catch (Exception ex)
		{
			Console.WriteLine("Error Massage : " + ex.Message);
		}
	}
}
