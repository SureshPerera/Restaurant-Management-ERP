@page "/Reservations"
@using ResortManagementApp.Models.Administration.ManageAgents
@using ResortManagementApp.Models.Reservation
@using ResortManagementApp.Models.Reservation.DTO
@using ResortManagementApp.Pages.ComponentCss
@using ResortManagementApp.Pages.Reservations.OnlineBookingModelCrud
@inject HttpClient Http

@layout MainLayout

<div>
	<h3 class="mb-3 text-center">Reservation Management</h3>
</div>
<div class="flex">
	<div class="" style="margin-left: -0.2rem">
		<div>
			<a href="/Reservations/DirectBooking" class="btn btn-primary mb-3">Direct Booking</a>
		</div>
		<div>
			<a href="/Reservations/AgentBooking" class="btn btn-primary mb-3">Agent Booking</a>
		</div>
		<div>
			<a href="/Reservations/OnlineBooking" class="btn btn-primary mb-3">Online Booking</a>
		</div>
	</div>
	
	<div class="flex-wrap" style="display:flex; flex-direction:column; gap:5rem;">
		<div class="justify-content-end flex flex-wrap gap-1" style="font-weight:bolder">
			<div style="">
				<input style="width: auto; height: 50px;" type="button" class="btn btn-warning mb-3 text-center" name="name" value="View all reservation" />
			</div>
			<div>
				<input style="width: auto; height: 50px;" type="button" class="btn btn-warning mb-3 text-center" name="name" value="View all confirmed reservation" />
			</div>
			<div>
				<input style="width: auto; height: 50px;" type="button" class="btn btn-warning mb-3 text-center" name="name" value="View all tempary reservation" />
			</div>
			<div>
				<input style="width: auto; height: 50px;" type="button" class="btn btn-warning mb-3 text-center" name="name" value="View all reservation by agent" />
			</div>
			<div>
				<input style="width: auto; height: 50px;" type="button" class="btn btn-warning mb-3 text-center" name="name" value="View all cancell reservation" />
			</div>
		</div>
		@* directBookingTable *@
		<div style="width : 300px;height: 200px;">
			<div>
				<label>Direct Booking List</label>
			</div>
			@if (directBookingModels == null)
			{
				<p><Searching/></p>
			}
			else
			{
				<table class="table">
					<thead class="bg-light">
						<tr class="table">
							<td>Name</td>
							<td>Phone Number</td>
							<td>Address</td>
							<td>EmailAddress</td>
							<td>NIC</td>
							<td>Customer Type</td>
							<td>CreditLimit</td>
							<td>OpeningBalanace</td>
							<td>Nationality</td>
							<td>Remark</td>


						</tr>
					</thead>
					<tbody class="bg-light">
						@foreach (var item in directBookingModels)
						{
							<tr>
								<th>@(item.FirstName + " " + @item.LastName)</th>

								<th>@item.PhoneNumber</th>
								<th>@item.Address</th>
								<th>@item.EmailAddress</th>
								<th>@item.NIC</th>
								<td>@item.CustomerType</td>
								<th>@item.CreditLimit</th>
								<th>@item.OpeningBalanace</th>
								<th>@item.Nationality</th>
								<th>@item.Remark</th>


							</tr>
						}
					</tbody>

				</table>
			}

		</div>
		@* onlineBookingTable *@
		
		<div style="width : 300px;height: 200px;">
			<div>
				<label>Online Booking List</label>
			</div>
			@if (OnlineBookings == null)
			{
				<p><Searching /></p>
			}
			else
			{
				<table class="table">
					<thead class="bg-light">
						<tr class="table">
							<td>Name</td>
							<td>Phone Number</td>
							<td>Address</td>
							<td>EmailAddress</td>
							<td>NIC</td>
							
							<td>CreditLimit</td>
							<td>OpeningBalanace</td>
							<td>Nationality</td>
							<td>Remark</td>


						</tr>
					</thead>
					<tbody class="bg-light">
						@foreach (var item in OnlineBookings)
						{
							<tr>
								<th>@(item.FirstName + " " + @item.LastName)</th>

								<th>@item.PhoneNumber</th>
								<th>@item.Address</th>
								<th>@item.EmailAddress</th>
								<th>@item.NIC</th>
								<th>@item.CreditLimit</th>
								<th>@item.OpeningBalanace</th>
								<th>@item.Nationality</th>
								<th>@item.Remark</th>


							</tr>
						}
					</tbody>

				</table>
			}

		</div>
		@* AgentBooking *@
		<div style="width : 300px;height: 200px;">
			<div>
				<label>Agent Booking List</label>
			</div>
			@if (Agents == null)
			{
				<p><Searching /></p>
			}
			else
			{
				<table class="table">
					<thead class="bg-light">
						<tr class="table">
							<td>Name</td>
							<td>Phone Number</td>
							<td>Address</td>
							<td>EmailAddress</td>
							<td>NIC</td>
							<td>CreditLimit</td>
						</tr>
					</thead>
					<tbody class="bg-light">
						@foreach (var item in Agents)
						{
							<tr>
								<th>@(item.AgentName )</th>

								<th>@item.Mobile</th>
								<th>@item.AgentAddress</th>
								<th>@item.Email</th>
								<th>@item.NIC</th>
								<th>@item.CreditLimit</th>
							</tr>
						}
					</tbody>

				</table>
			}

		</div>
	</div>
</div>





@code {
    private List<DirectBookingModel>? directBookingModels;
    private List<OnlineBookingDto>? OnlineBookings;
    private List<Agents>? Agents;

	protected override async Task OnInitializedAsync()
	{
		try
		{
			directBookingModels = await Http.GetFromJsonAsync<List<DirectBookingModel>>("https://localhost:4000/api/DirectBooking");
			OnlineBookings = await Http.GetFromJsonAsync<List<OnlineBookingDto>>("https://localhost:4000/api/OnlineBooking");
			Agents = await Http.GetFromJsonAsync<List<Agents>>("https://localhost:4000/api/Agent");

		}
		catch (Exception ex)
		{
			Console.WriteLine("Error Massage : " + ex.Message);
		}
	}
}
